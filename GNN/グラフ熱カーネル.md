# グラフ熱カーネル(WIP)

グラフ熱カーネルは[[グラフラプラシアン]]の行列指数関数を用いて、**グラフ上の拡散過程を通じて頂点間の類似度を評価する手法**です。時間パラメータ $t$ を調整することで、局所的な構造から大域的な構造までを連続的に探索できます。

## 起源
グラフ熱カーネルの概念は，もともと[[リーマン多様体]]上の[[熱カーネル]]解析に由来し，これをグラフ理論に適用した離散化手法です。特に[[グラフラプラシアン]]のスペクトル解析と結びつき，スペクトルグラフ理論やグラフ信号処理，機械学習におけるネットワーク解析の分野で発展しました。

## グラフの前提
グラフ熱カーネルで扱うグラフ $G=(V, E)$ は、自己ループや多重辺を持たない単純無向グラフとし、辺の重みを非負実数と仮定します。このグラフを隣接行列 $A$ と次数行列 $D$ で表し、[[グラフラプラシアン]] $L=D-A$ を構成します。拡散過程が全頂点に及ぶことを前提として、通常は連結なグラフを対象とします。

## 行列指数関数
グラフ熱カーネルでは，グラフラプラシアン$L$に対し，時間パラメータ$t$を乗じた，行列指数関数 $
\exp(-tL)$を用います。行列指数関数は以下の級数展開で定義され，拡散過程に対応する確率遷移行列として解釈できます：

$$
\exp(-tL)=\sum_{k=0}^\infty\frac{(-tL)^k}{k!}
$$

ここで、$k$は非負整数の添字で、級数展開における各項で行列$L$が何回乗算されるか（拡散のステップ次数）を示します。

また，$L$の[[固有値分解]]$L=U\Lambda U^\top$を利用すると，

$$
\exp(-tL)=U\exp(-t\Lambda)U^\top
$$

の形で効率的に計算できます。ここで，対角行列$\exp(-t\Lambda)$の対角要素は$\exp(-t\lambda_i)$です。この性質により，拡散のスケールを固有値 $\lambda$ ごとに制御し，局所的から大域的構造まで連続的に把握できます。


各固有値 $\lambda_i$ に対応する固有ベクトル成分は，係数 $\exp(-t\lambda_i)$ によって重み付けされます。固有値が小さい成分（低周波）は減衰が緩やかで大域的構造を反映し，固有値が大きい成分（高周波）は急速に減衰して局所構造を強調します。したがって，時間パラメータ $t$ を調整することで，各固有モードの寄与を制御し，任意のスケールでグラフの特徴を抽出できます。