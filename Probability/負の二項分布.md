# 負の二項分布

負の二項分布は、[[二項分布]]とは異なる視点でベルヌーイ試行（成功/失敗の2つの結果しかない試行）を考える確率分布です。

## 基本的な概念

負の二項分布は「**r回の成功を達成するまでに必要な試行回数**」の確率分布を表します。つまり、最後の試行で目標の成功回数に到達することが条件となります。

例えば：
- 5回目の当たりくじを引くまでに必要なくじの購入回数
- 10人目の特定条件を満たす顧客に出会うまでの対応人数
- 3回ホームランを打つまでに必要な打席数

## 数学的表現

負の二項分布は通常 NB(r, p) と表記されます：
- r: 目標とする成功回数
- p: 各試行での成功確率

確率質量関数（PMF）は次のように定義されます：

$$
P(X = k)=\binom{k-1}{r-1} p^r (1-p)^{k-r}
$$

ここで：
- X は目標の成功回数rを達成するために必要な総試行回数
- $\binom{k-1}{r-1}$ は二項係数

二項係数が $\binom{k}{r}$ ではなく，$\binom{k-1}{r-1}$ であるのは，負の二項分布では，最後の試行は「成功」だという前提があるから．
## 特性値

- 期待値（平均）: $E[X] = r/p$
- 分散: $Var(X) = r(1-p)/p^2$

## 二項分布との違い

二項分布と負の二項分布の重要な違いは：
- **二項分布**：試行回数n**が固定**され、その中での成功回数が確率変数
- **負の二項分布**：成功回数r**が固定**され、それを達成するための試行回数が確率変数

## 特殊なケース

- r=1のとき、負の二項分布は[[幾何分布]]と一致します（最初の成功までの試行回数）

## 応用

負の二項分布は以下のような場面で使われます：
- 特定の目標を達成するまでの時間やコストの予測
- 品質管理（一定数の不良品を見つけるまでの検査数）
- 感染症モデリング
- 顧客獲得や販売プロセスの分析

負の二項分布は、「目標達成までに何回の試行が必要か」という問題を扱う多くの実際の状況をモデル化するのに適しています。