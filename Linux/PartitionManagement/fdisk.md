# fdiskコマンド

## fdiskとは
fdiskはLinuxシステムでディスクパーティションを管理するためのコマンドラインユーティリティです。ハードディスクやSSDなどのストレージデバイスのパーティション作成、変更、削除を行うことができます。

## 基本的な使い方
```bash
sudo fdisk デバイス名
```

例：
```bash
sudo fdisk /dev/sda
```

> **注意**: fdiskの実行には通常root権限が必要です。

## 主なオプション

| オプション | 説明 |
|------------|------|
| `-l` | パーティションテーブルを表示するのみ（読み取り専用モード） |
| `-b サイズ` | セクタサイズを指定（デフォルトは512バイト） |
| `-u` | 表示単位をシリンダからセクタに変更 |
| `-s パーティション` | 指定したパーティションのサイズを表示 |
| `-c` | DOS互換モードを無効化 |
| `-v` | fdiskのバージョンを表示 |

## 対話モードのサブコマンド

fdiskを実行すると対話モードになり、以下のサブコマンドが使用できます：

| コマンド | 説明                         |
| ---- | -------------------------- |
| `m`  | ヘルプメニューを表示                 |
| `p`  | 現在のパーティションテーブルを表示          |
| `n`  | 新しいパーティションを作成              |
| `d`  | パーティションを削除                 |
| `l`  | 利用可能なパーティションタイプの一覧を表示      |
| `t`  | パーティションのタイプ（ID）を変更         |
| `v`  | パーティションテーブルを検証             |
| `o`  | 新しいDOSパーティションテーブルを作成       |
| `g`  | 新しいGPTパーティションテーブルを作成       |
| `w`  | パーティションテーブルを書き込んで終了（変更を保存） |
| `q`  | 変更を保存せずに終了                 |
| `F`  | パーティションされてない領域のサイズを表示      |

## 一般的な使用例

1. **パーティションテーブルの表示**
   ```bash
   sudo fdisk -l
   ```

2. **新しいパーティションの作成プロセス**
   ```bash
   sudo fdisk /dev/sda
   # nを入力して新しいパーティション
   # pかeを選択（基本/拡張）
   # パーティション番号を入力
   # 開始セクタを入力（または Enter でデフォルト）
   # 終了セクタまたはサイズを入力
   # wを入力して保存
   ```

3. **パーティションの削除**
   ```bash
   sudo fdisk /dev/sda
   # dを入力
   # 削除するパーティション番号を入力
   # wを入力して保存
   ```

> **重要**: fdiskでの変更はwコマンドを実行するまで実際にディスクに書き込まれません。また、使用中のパーティションを変更する場合は、事前にアンマウントが必要です。

# GPT形式のディスクとfdiskの関係

## fdiskはGPT形式のディスクに使用できます

最新のfdisk（util-linuxパッケージの一部）は、GPT（GUID Partition Table）形式のディスクの操作に対応しています。ただし、いくつかの注意点があります。

## fdiskでのGPT操作

1. **GPTパーティションテーブルの作成**
   ```bash
   sudo fdisk /dev/sdX
   Command (m for help): g  # 新しいGPTパーティションテーブルを作成
   ```

2. **GPTパーティションの表示**
   ```bash
   sudo fdisk -l /dev/sdX  # GPTディスクのパーティション情報を表示
   ```

3. **基本的なパーティション管理**
   - パーティションの作成、削除、サイズ変更などの基本操作はMBRと同様に可能

## 制限事項と代替ツール

fdiskでGPTディスクを扱う際には以下の制限があります：

- 一部の高度なGPT固有機能（パーティション名の設定など）が利用できない
- 古いバージョンのfdiskではGPTディスクの操作が制限される場合がある

このため、GPTディスクの管理には以下の専用ツールがより適しています：

| ツール         | 説明                               |
| ----------- | -------------------------------- |
| [[gdisk]]   | GPT専用のfdisk風ツール（GPT fdiskとも呼ばれる） |
| [[parted]]  | より高機能なパーティショニングツール（GPTを完全サポート）   |
| [[gparted]] | partedのGUIフロントエンド                |

## まとめ

- 現代のfdiskはGPTディスクの基本的な操作をサポートしています
- 高度なGPT機能や信頼性を求める場合は、gdiskやpartedの使用が推奨されます
- ディスクの重要なデータを操作する前には、常にバックアップを取ることをお勧めします